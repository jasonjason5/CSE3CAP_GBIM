

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Functions &mdash; CSE3CAP 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            CSE3CAP
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">CSE3CAP_GBIM</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CSE3CAP</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">Functions</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for Functions</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">INT</span>
<span class="kn">from</span> <span class="nn">turtle</span> <span class="kn">import</span> <span class="n">width</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">ImageTk</span><span class="p">,</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageOps</span><span class="p">,</span> <span class="n">ImageTk</span><span class="p">,</span> <span class="n">ImageEnhance</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">messagebox</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">filedialog</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">add</span>
<span class="kn">import</span> <span class="nn">mouse</span>
<span class="kn">import</span> <span class="nn">pyautogui</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">ImageEnhance</span>
<span class="kn">import</span> <span class="nn">mouse</span>

<div class="viewcode-block" id="editFunctions">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions">[docs]</a>
<span class="k">class</span> <span class="nc">editFunctions</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       
        <span class="c1">##Application Componentry References </span>

        <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">:</span> <span class="n">Image</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_image</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">screenDimensions</span> <span class="o">=</span> <span class="n">pyautogui</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
       
       <span class="c1">## Image properties References</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">start_width</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_height</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_pos</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_rot</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_image</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_width</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_height</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_rot</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">penHold</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">penFrameCounter</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1">## Crop Properties References</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cropStage</span> <span class="o">=</span> <span class="s2">&quot;move&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cropImage</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropOverlay</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropBounds</span> <span class="o">=</span> <span class="kc">None</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">cropDim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cropBox_Sheight</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropBox_Swidth</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropBox_Uheight</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropBox_Uwidth</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1">## History References</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">historyDoAdd</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;cropexit&quot;</span><span class="p">,</span><span class="s2">&quot;rotate&quot;</span><span class="p">,</span><span class="s2">&quot;brightness&quot;</span><span class="p">,</span><span class="s2">&quot;contrast&quot;</span><span class="p">,</span><span class="s2">&quot;resize&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imageHistory</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canRedo</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1">## INPUT: image, the variable containing the canvas, the canvas object</span>
    <span class="c1">## FUNCTION: Initialises all required references within the Function object. Enables the object to be instatiateed without references.</span>
<div class="viewcode-block" id="editFunctions.setRefs">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.setRefs">[docs]</a>
    <span class="k">def</span> <span class="nf">setRefs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">canvas_image</span><span class="p">,</span> <span class="n">canvas</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">getimage</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">canvas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas_image</span> <span class="o">=</span> <span class="n">canvas_image</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">start_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_pos</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_image</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">update_image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">update_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_rot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_rot</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">imageHistory</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)</span></div>


    <span class="c1">## INPUT: Landmark results, Index</span>
    <span class="c1">## OUTPUT: Specific landmark coordinates</span>
    <span class="k">def</span> <span class="nf">_get_landmark</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">multi_hand_landmarks</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">results</span><span class="o">.</span><span class="n">multi_hand_landmarks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">landmark</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1">## INPUT: Landmark Results</span>
    <span class="c1">## FUNCTION: Calculates distance between initial point of gesture and current point of gesture,</span>
    <span class="c1">## applies proportional distance as scaling operation to image. Updates references.</span>
<div class="viewcode-block" id="editFunctions.resize">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.resize">[docs]</a>
    <span class="k">def</span> <span class="nf">resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="o">=</span> <span class="n">results</span>

        <span class="n">start_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_landmark</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_results</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="n">current_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_landmark</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">start_point</span> <span class="ow">and</span> <span class="n">current_point</span><span class="p">:</span>
            <span class="n">distance</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">start_point</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">current_point</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">start_point</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">current_point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">scaler</span> <span class="o">=</span> <span class="n">distance</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">current_point</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">start_point</span><span class="o">.</span><span class="n">x</span> <span class="ow">and</span> <span class="n">current_point</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">start_point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="ow">or</span> \
               <span class="p">(</span><span class="n">current_point</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">start_point</span><span class="o">.</span><span class="n">x</span> <span class="ow">and</span> <span class="n">current_point</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="n">start_point</span><span class="o">.</span><span class="n">y</span><span class="p">):</span>
                <span class="n">scaler</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">scaler</span>

            <span class="n">resize_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_width</span> <span class="o">*</span> <span class="n">scaler</span>
            <span class="n">resize_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_height</span> <span class="o">*</span> <span class="n">scaler</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">update_width</span> <span class="o">=</span> <span class="n">resize_width</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_height</span> <span class="o">=</span> <span class="n">resize_height</span>

            <span class="n">resized_image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">resize_width</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">resize_height</span><span class="p">)),</span> <span class="n">Image</span><span class="o">.</span><span class="n">Resampling</span><span class="o">.</span><span class="n">LANCZOS</span><span class="p">)</span>
            <span class="n">resized_out</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">resized_image</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">update_image</span> <span class="o">=</span> <span class="n">resized_image</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_image</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">resized_out</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">imgref</span> <span class="o">=</span> <span class="n">resized_out</span></div>


    <span class="c1">## INPUT: Landmark Results</span>
    <span class="c1">## FUNCTION: Applies landmark coordinates to image coordinates. Moves image.</span>
<div class="viewcode-block" id="editFunctions.translate">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.translate">[docs]</a>
    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="o">=</span> <span class="n">results</span>

        <span class="n">current_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_landmark</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="n">current_point</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">current_point</span><span class="o">.</span><span class="n">x</span> <span class="c1"># Inverting x axis</span>
        <span class="n">cWidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_reqwidth</span><span class="p">()</span>
        <span class="n">cHeight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_reqheight</span><span class="p">()</span>
        
        <span class="n">anchorOffsetX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_height</span> <span class="o">/</span> <span class="mi">2</span> <span class="c1"># Offsetting central anchor of image</span>
        <span class="n">anchorOffsetY</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_width</span> <span class="o">/</span> <span class="mi">2</span>
        
        <span class="k">if</span> <span class="n">current_point</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">moveto</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_image</span><span class="p">,</span> <span class="n">current_point</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">cWidth</span> <span class="o">-</span> <span class="n">anchorOffsetX</span><span class="p">,</span> <span class="n">current_point</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">cHeight</span> <span class="o">-</span> <span class="n">anchorOffsetY</span><span class="p">)</span> </div>


    <span class="c1">## INPUT: Array of 15 degree increments, current rotation </span>
    <span class="c1">## OUTPUT: Rotation value snapped to the nearest increment</span>
<div class="viewcode-block" id="editFunctions.snap">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.snap">[docs]</a>
    <span class="k">def</span> <span class="nf">snap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">array</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="n">snapped</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">array</span><span class="o">-</span><span class="n">value</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">snapped</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">array</span><span class="p">[</span><span class="n">snapped</span><span class="p">]</span></div>


    <span class="c1">## INPUT: Results</span>
    <span class="c1">## FUNCTION: Rotates the image based on the relative rotation of two landmarks. Updates references</span>
<div class="viewcode-block" id="editFunctions.rotate">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.rotate">[docs]</a>
    <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="o">=</span> <span class="n">results</span>

        <span class="n">start_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_landmark</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_results</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="n">current_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_landmark</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">pivot_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_landmark</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">start_point</span> <span class="ow">and</span> <span class="n">current_point</span> <span class="ow">and</span> <span class="n">pivot_point</span><span class="p">:</span>
                
            <span class="n">rot_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">([</span><span class="n">current_point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">current_point</span><span class="o">.</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">pivot_point</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pivot_point</span><span class="o">.</span><span class="n">y</span><span class="p">])</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">rot_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rot_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">out_rot</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span> <span class="o">-</span> <span class="mi">90</span><span class="p">)</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">210</span><span class="p">,</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">75</span><span class="p">,</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span><span class="o">-</span><span class="mi">45</span><span class="p">,</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">210</span><span class="p">])</span> <span class="c1">## Snaps to 15/30 degree increments</span>
            <span class="n">out_rot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">snap</span><span class="p">(</span><span class="n">array</span><span class="p">,</span><span class="n">out_rot</span><span class="p">)</span>


            <span class="bp">self</span><span class="o">.</span><span class="n">update_rot</span> <span class="o">=</span> <span class="n">out_rot</span>

            <span class="n">rotated_image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_rot</span> <span class="o">+</span> <span class="n">out_rot</span><span class="p">)</span>
            <span class="n">rez_rot_image</span> <span class="o">=</span> <span class="n">rotated_image</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_width</span><span class="p">),</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_height</span><span class="p">)))</span> <span class="c1">## Avoids the rotated image becoming massive for some reason </span>
            <span class="n">rotated_out</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">rez_rot_image</span><span class="p">)</span>
            
            
            <span class="bp">self</span><span class="o">.</span><span class="n">update_image</span> <span class="o">=</span> <span class="n">rez_rot_image</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_image</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">rotated_out</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">imgref</span> <span class="o">=</span> <span class="n">rotated_out</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">imgref</span> <span class="o">=</span> <span class="n">rotated_out</span></div>


    <span class="c1">## INPUT: Nil</span>
    <span class="c1">## FUNCTION: Creates crop overlay image, updates crop-specific references. </span>
<div class="viewcode-block" id="editFunctions.createCropBounds">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.createCropBounds">[docs]</a>
    <span class="k">def</span> <span class="nf">createCropBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropImage</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;RGBA&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">153</span><span class="p">,</span><span class="mi">153</span><span class="p">,</span><span class="mi">153</span><span class="p">,</span><span class="mi">127</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropOverlay</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cropImage</span><span class="p">)</span>

        <span class="n">canvasCentre</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">75</span><span class="p">)</span> <span class="c1"># Hardcoded value to get the crop box overlay roughly in centre</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cropBounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_image</span><span class="p">(</span><span class="n">canvasCentre</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">canvasCentre</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cropOverlay</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span> <span class="c1">#Creates a new image on the canvas</span>
        
        <span class="n">sWidth</span><span class="p">,</span> <span class="n">sHeight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cropImage</span><span class="o">.</span><span class="n">size</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cropBox_Swidth</span> <span class="o">=</span> <span class="n">sWidth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropBox_Sheight</span> <span class="o">=</span> <span class="n">sHeight</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropDim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sWidth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropDim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sHeight</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cropStage</span> <span class="o">=</span> <span class="s2">&quot;scale&quot;</span> </div>


    <span class="c1">## INPUT: Nil</span>
    <span class="c1">## FUNCTION: Applies the crop. Locates crop window position and image position, subtracts difference in pixels</span>
<div class="viewcode-block" id="editFunctions.applyCrop">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.applyCrop">[docs]</a>
    <span class="k">def</span> <span class="nf">applyCrop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1">## All the coordinates need to be adjusted by the image dimensions due to the center anchor placement of the canvas objects    </span>

        <span class="n">cropBoxCoordsTL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cropBounds</span><span class="p">)</span>
        <span class="n">cropBoxCoordsTL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cropDim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">cropBoxCoordsTL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cropDim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
        
        <span class="n">imageCoordsTL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_image</span><span class="p">)</span>
        <span class="n">imageCoordsTL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_width</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">imageCoordsTL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_height</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">cropBoxCoordsBR</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">add</span><span class="p">,</span><span class="n">cropBoxCoordsTL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cropDim</span><span class="p">))</span>
        <span class="n">BRimSize</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_width</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">start_height</span><span class="p">)</span>
        <span class="n">imageCoordsBR</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">add</span><span class="p">,</span><span class="n">imageCoordsTL</span><span class="p">,</span><span class="n">BRimSize</span><span class="p">))</span>

        
        <span class="nb">print</span><span class="p">(</span><span class="n">cropBoxCoordsTL</span><span class="p">,</span><span class="n">cropBoxCoordsBR</span><span class="p">,</span><span class="n">imageCoordsTL</span><span class="p">,</span><span class="n">imageCoordsBR</span><span class="p">)</span>
        
        <span class="n">LCrop</span> <span class="o">=</span> <span class="o">-</span><span class="n">imageCoordsTL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">cropBoxCoordsTL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
        <span class="n">TCrop</span> <span class="o">=</span> <span class="o">-</span><span class="n">imageCoordsTL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">cropBoxCoordsTL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">RCrop</span> <span class="o">=</span> <span class="n">imageCoordsBR</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">cropBoxCoordsBR</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">BCrop</span> <span class="o">=</span> <span class="n">imageCoordsBR</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">cropBoxCoordsBR</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">crop</span> <span class="o">=</span> <span class="p">(</span><span class="n">LCrop</span><span class="p">,</span><span class="n">TCrop</span><span class="p">,</span><span class="n">RCrop</span><span class="p">,</span><span class="n">BCrop</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">crop</span><span class="p">)</span>

        <span class="k">if</span><span class="p">(</span><span class="n">RCrop</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">TCrop</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">LCrop</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">BCrop</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span><span class="c1">#I.E The crop box is bigger than the image </span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Crop Error&quot;</span><span class="p">,</span><span class="s2">&quot;Potential crop is larger than image dimensions. Try a smaller crop.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;POTENTIAL CROP IS LARGER THAN IMAGE&quot;</span><span class="p">)</span>
            <span class="k">return</span>
           
        <span class="n">update_image</span> <span class="o">=</span> <span class="n">ImageOps</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span><span class="n">crop</span><span class="p">)</span>
        <span class="n">update_width</span><span class="p">,</span><span class="n">update_height</span> <span class="o">=</span> <span class="n">update_image</span><span class="o">.</span><span class="n">size</span>
           
        <span class="bp">self</span><span class="o">.</span><span class="n">update_image</span> <span class="o">=</span> <span class="n">update_image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_height</span> <span class="o">=</span> <span class="n">update_height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_width</span> <span class="o">=</span> <span class="n">update_width</span>

        <span class="n">canvasOut</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">update_image</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_image</span><span class="p">,</span><span class="n">image</span><span class="o">=</span><span class="n">canvasOut</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">imgref</span> <span class="o">=</span> <span class="n">canvasOut</span></div>

          
    <span class="c1">## INPUT: exit boolean</span>
    <span class="c1">## FUNCTION: Destroys crop overlay, empties references. Checks to see if crop should be applied before exiting.</span>
<div class="viewcode-block" id="editFunctions.destroyCropBounds">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.destroyCropBounds">[docs]</a>
    <span class="k">def</span> <span class="nf">destroyCropBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">exit</span><span class="p">):</span>
        <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cropBounds</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">exit</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">applyCrop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cropBounds</span><span class="p">)</span>
           
        <span class="bp">self</span><span class="o">.</span><span class="n">cropOverlay</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropImage</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span>
           
        <span class="bp">self</span><span class="o">.</span><span class="n">cropStage</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropBounds</span> <span class="o">=</span> <span class="kc">None</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">cropDim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">cropBox_Sheight</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropBox_Swidth</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropBox_Uheight</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropBox_Uwidth</span> <span class="o">=</span> <span class="kc">None</span></div>

    
    <span class="c1">## INPUT: Nil</span>
    <span class="c1">## FUNCTION: Resets crop stage</span>
<div class="viewcode-block" id="editFunctions.resetCropStage">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.resetCropStage">[docs]</a>
    <span class="k">def</span> <span class="nf">resetCropStage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cropStage</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span></div>

        
    <span class="c1">## INPUT: Landmark Results</span>
    <span class="c1">## FUNCTION: Two steop crop process - positioning and resizing. Updates references for crop operations.</span>
<div class="viewcode-block" id="editFunctions.crop">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.crop">[docs]</a>
    <span class="k">def</span> <span class="nf">crop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
        
        <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cropStage</span> <span class="o">==</span> <span class="s2">&quot;move&quot;</span><span class="p">):</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="o">=</span> <span class="n">results</span>

            <span class="n">current_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_landmark</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
            <span class="n">cWidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_reqwidth</span><span class="p">()</span>
            <span class="n">cHeight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">winfo_reqheight</span><span class="p">()</span>
        
            <span class="k">if</span> <span class="n">current_point</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">moveto</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cropBounds</span><span class="p">,</span> <span class="n">current_point</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">cWidth</span><span class="p">,</span> <span class="n">current_point</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">cHeight</span><span class="p">)</span> <span class="c1">#</span>
                
        <span class="k">elif</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cropStage</span> <span class="o">==</span> <span class="s2">&quot;scale&quot;</span><span class="p">):</span>
            

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="o">=</span> <span class="n">results</span>

            <span class="n">start_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_landmark</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_results</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
            <span class="n">current_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_landmark</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">start_point</span> <span class="ow">and</span> <span class="n">current_point</span><span class="p">:</span>

                <span class="n">distance</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">start_point</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">current_point</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">start_point</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">current_point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">scaler</span> <span class="o">=</span> <span class="n">distance</span> <span class="o">+</span> <span class="mi">1</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">current_point</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">start_point</span><span class="o">.</span><span class="n">x</span> <span class="ow">and</span> <span class="n">current_point</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">start_point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="ow">or</span> \
                   <span class="p">(</span><span class="n">current_point</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">start_point</span><span class="o">.</span><span class="n">x</span> <span class="ow">and</span> <span class="n">current_point</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="n">start_point</span><span class="o">.</span><span class="n">y</span><span class="p">):</span>
                    <span class="n">scaler</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">scaler</span>

                <span class="n">resize_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cropBox_Swidth</span> <span class="o">*</span> <span class="n">scaler</span>
                <span class="n">resize_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cropBox_Sheight</span> <span class="o">*</span> <span class="n">scaler</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">cropBox_Uwidth</span> <span class="o">=</span> <span class="n">resize_width</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cropBox_Uheight</span> <span class="o">=</span> <span class="n">resize_height</span>

                <span class="n">resized_image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cropImage</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">resize_width</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">resize_height</span><span class="p">)),</span> <span class="n">Image</span><span class="o">.</span><span class="n">Resampling</span><span class="o">.</span><span class="n">LANCZOS</span><span class="p">)</span>
                <span class="n">resized_out</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">resized_image</span><span class="p">)</span>
            
                <span class="bp">self</span><span class="o">.</span><span class="n">cropDim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">resized_image</span><span class="o">.</span><span class="n">width</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cropDim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">resized_image</span><span class="o">.</span><span class="n">height</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cropDim</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cropBounds</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">resized_out</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">resized_out</span> </div>


    <span class="c1">## INPUT: Landmark Results</span>
    <span class="c1">## FUNCTION: Moves mouse proportionally based on landmark coordinates</span>
<div class="viewcode-block" id="editFunctions.pointer">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.pointer">[docs]</a>
    <span class="k">def</span> <span class="nf">pointer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results</span><span class="p">):</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="o">=</span> <span class="n">results</span>

        <span class="n">indexMouse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_landmark</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="n">fingPosx</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">indexMouse</span><span class="o">.</span><span class="n">x</span>
        <span class="n">fingPosy</span> <span class="o">=</span> <span class="n">indexMouse</span><span class="o">.</span><span class="n">y</span>

        <span class="n">relX</span> <span class="o">=</span> <span class="n">fingPosx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenDimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">relY</span> <span class="o">=</span> <span class="n">fingPosy</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenDimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.35</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">penHold</span> <span class="o">=</span> <span class="p">(</span><span class="n">relX</span><span class="p">,</span><span class="n">relY</span><span class="p">)</span>

        <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">penHold</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">&lt;=</span> <span class="n">relX</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">penHold</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">10</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">penHold</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">&lt;=</span> <span class="n">relY</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">penHold</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">10</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">penFrameCounter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">penFrameCounter</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">):</span>
            <span class="n">mouse</span><span class="o">.</span><span class="n">click</span><span class="p">(</span><span class="n">button</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">penFrameCounter</span> <span class="o">=</span> <span class="mi">0</span>

    
        <span class="n">mouse</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">relX</span><span class="p">,</span><span class="n">relY</span><span class="p">)</span></div>

       
    <span class="c1">## INPUT: B/C Value</span>
    <span class="c1">## OUTPUT: Clamped value</span>
<div class="viewcode-block" id="editFunctions.clamp">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.clamp">[docs]</a>
    <span class="k">def</span> <span class="nf">clamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span><span class="p">(</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">5</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span></div>


    <span class="c1">## INPUT: Landmark Results</span>
    <span class="c1">## FUNCTION: Increases / Decreases image brightness based on landmark position</span>
<div class="viewcode-block" id="editFunctions.brightness">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.brightness">[docs]</a>
    <span class="k">def</span> <span class="nf">brightness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="o">=</span> <span class="n">results</span>

        <span class="c1"># Get start and current positions for the pinky finger (landmark index 20)</span>
        <span class="n">start_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_landmark</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_results</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="n">current_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_landmark</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">start_point</span> <span class="ow">and</span> <span class="n">current_point</span><span class="p">:</span>
            <span class="n">delta_y</span> <span class="o">=</span> <span class="n">start_point</span><span class="o">.</span><span class="n">y</span>  <span class="o">-</span>  <span class="n">current_point</span><span class="o">.</span><span class="n">y</span>
            <span class="n">brightness_factor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">delta_y</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">)</span>
            <span class="n">clampedBF</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="n">brightness_factor</span><span class="p">)</span>
            <span class="c1"># Apply brightness adjustment using ImageEnhance.Brightness</span>
            <span class="n">enhancer</span> <span class="o">=</span> <span class="n">ImageEnhance</span><span class="o">.</span><span class="n">Brightness</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
            <span class="n">brightened_image</span> <span class="o">=</span> <span class="n">enhancer</span><span class="o">.</span><span class="n">enhance</span><span class="p">(</span><span class="n">clampedBF</span><span class="p">)</span>
            <span class="n">brightened_out</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">brightened_image</span><span class="p">)</span>

            <span class="c1"># Update the canvas and image with the new brightened image</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_image</span> <span class="o">=</span> <span class="n">brightened_image</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_image</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">brightened_out</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">imgref</span> <span class="o">=</span> <span class="n">brightened_out</span></div>

    
    <span class="c1">## INPUT: Landmark Results</span>
    <span class="c1">## FUNCTION: Increases / Decreases image contrast based on landmark position   </span>
<div class="viewcode-block" id="editFunctions.contrast">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.contrast">[docs]</a>
    <span class="k">def</span> <span class="nf">contrast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="o">=</span> <span class="n">results</span>

        <span class="c1"># Get start and current positions for the pinky finger (landmark index 20)</span>
        <span class="n">start_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_landmark</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_results</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="n">current_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_landmark</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">start_point</span> <span class="ow">and</span> <span class="n">current_point</span><span class="p">:</span>
            <span class="n">delta_y</span> <span class="o">=</span> <span class="n">current_point</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">start_point</span><span class="o">.</span><span class="n">x</span>
            <span class="n">contrast_factor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">delta_y</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">)</span>
            <span class="n">clampedCF</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="n">contrast_factor</span><span class="p">)</span>
            <span class="c1"># Apply Contrast adjustment using ImageEnhance.Contrast</span>
            <span class="n">enhancer</span> <span class="o">=</span> <span class="n">ImageEnhance</span><span class="o">.</span><span class="n">Contrast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
            <span class="n">contrasted_image</span> <span class="o">=</span> <span class="n">enhancer</span><span class="o">.</span><span class="n">enhance</span><span class="p">(</span><span class="n">clampedCF</span><span class="p">)</span>
            <span class="n">contrasted_out</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">contrasted_image</span><span class="p">)</span>

            <span class="c1"># Update the canvas and image with the new brightened image</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_image</span> <span class="o">=</span> <span class="n">contrasted_image</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_image</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">contrasted_out</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">imgref</span> <span class="o">=</span> <span class="n">contrasted_out</span></div>


    <span class="c1">## Undo and redo usurp set_start as a function, and perform the resetting of variables by themselves to ensure continuity</span>

    <span class="c1">## INPUT: Nil</span>
    <span class="c1">## FUNCTION: Updates references with image stored in history</span>
<div class="viewcode-block" id="editFunctions.undo">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.undo">[docs]</a>
    <span class="k">def</span> <span class="nf">undo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imageHistory</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">imageHistory</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">tkUndo</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imageHistory</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">start_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">width</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">height</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_image</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_rot</span> <span class="o">=</span> <span class="mi">0</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_image</span><span class="p">,</span><span class="n">image</span><span class="o">=</span><span class="n">tkUndo</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">imgref</span> <span class="o">=</span> <span class="n">tkUndo</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">canRedo</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1">## I have undone. I can now redo to a undo an undo.</span></div>

        
    <span class="c1">## INPUT: Nil</span>
    <span class="c1">## FUNCTION: Updates references with iamge stored in history</span>
<div class="viewcode-block" id="editFunctions.redo">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.redo">[docs]</a>
    <span class="k">def</span> <span class="nf">redo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canRedo</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">imageHistory</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">tkRedo</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imageHistory</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">start_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">width</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">height</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_image</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_rot</span> <span class="o">=</span> <span class="mi">0</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">itemconfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas_image</span><span class="p">,</span><span class="n">image</span><span class="o">=</span><span class="n">tkRedo</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">imgref</span> <span class="o">=</span> <span class="n">tkRedo</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">canRedo</span> <span class="o">=</span> <span class="kc">False</span></div>


    <span class="c1">## INPUT: edit performed</span>
    <span class="c1">## FUNCTION: Conditionally adds a copy of the image to array for undo/redo. Shifts crop state, resets/updates value.</span>
    <span class="c1">## Handles all end-of-gesture processes in preparation for the enxt gesture</span>
<div class="viewcode-block" id="editFunctions.set_start">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.set_start">[docs]</a>
    <span class="k">def</span> <span class="nf">set_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">edit</span><span class="p">):</span>

        <span class="k">if</span><span class="p">(</span><span class="n">edit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">historyDoAdd</span><span class="p">):</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imageHistory</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">imageHistory</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imageHistory</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">update_image</span><span class="p">)</span>
           
        <span class="bp">self</span><span class="o">.</span><span class="n">start_results</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Resetting start position of gesture coordinates</span>
       
        <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cropStage</span> <span class="o">==</span> <span class="s2">&quot;move&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cropStage</span> <span class="o">=</span> <span class="s2">&quot;scale&quot;</span>
        <span class="k">elif</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cropStage</span> <span class="o">==</span> <span class="s2">&quot;scale&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cropStage</span> <span class="o">=</span> <span class="s2">&quot;move&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cropStage</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>
        
        <span class="c1">#Update Values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_rot</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">penHold</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">penFrameCounter</span> <span class="o">=</span> <span class="mi">0</span></div>

        
    <span class="c1">## Input: Nil</span>
    <span class="c1">## FUNCTION: Returns image for save preview</span>
<div class="viewcode-block" id="editFunctions.return_image">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.return_image">[docs]</a>
    <span class="k">def</span> <span class="nf">return_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outputImage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stripAlpha</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">outputImage</span></div>

    
    <span class="c1">## Input: Nil</span>
    <span class="c1">## FUNCTION: Returns alpha-stripped image to remove padding for saving</span>
<div class="viewcode-block" id="editFunctions.stripAlpha">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.stripAlpha">[docs]</a>
    <span class="k">def</span> <span class="nf">stripAlpha</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">initial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span>
        <span class="n">arrayImage</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">initial</span><span class="p">)</span>
        <span class="n">cropCoord</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">breakbool</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="c1">## Find the earliest vertical occurence of a non-alpha pixel</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">start_width</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_height</span><span class="p">):</span>
                <span class="k">if</span><span class="p">(</span><span class="n">arrayImage</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span> <span class="c1">## Approaching from the left</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Width Distance:&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">cropCoord</span><span class="p">)</span>
                    <span class="n">breakbool</span>  <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
            <span class="n">cropCoord</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span><span class="p">(</span><span class="n">breakbool</span><span class="p">):</span>
                <span class="k">break</span>
              
        <span class="n">breakbool</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">heightCropAmount</span> <span class="o">=</span> <span class="n">cropCoord</span>
        <span class="n">cropCoord</span> <span class="o">=</span> <span class="mi">0</span>        

        <span class="c1">## Find the earliest horizontal occurence of a non-alpha pixel</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">start_height</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">start_width</span><span class="p">):</span>
                <span class="k">if</span><span class="p">(</span><span class="n">arrayImage</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span> <span class="c1">## Approaching from the top</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Height Distance:&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">cropCoord</span><span class="p">)</span>
                    <span class="n">breakbool</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>

            <span class="n">cropCoord</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span><span class="p">(</span><span class="n">breakbool</span><span class="p">):</span>
                <span class="k">break</span>

        <span class="n">widthCropAmount</span> <span class="o">=</span> <span class="n">cropCoord</span>
        <span class="n">cropCoord</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="n">strippedImage</span> <span class="o">=</span> <span class="n">ImageOps</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,(</span><span class="n">widthCropAmount</span><span class="p">,</span><span class="n">heightCropAmount</span><span class="p">,</span><span class="n">widthCropAmount</span><span class="p">,</span><span class="n">heightCropAmount</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">strippedImage</span></div>


            
    <span class="c1">## INPUT: Nil</span>
    <span class="c1">## FUNCTION: Saves Image</span>
<div class="viewcode-block" id="editFunctions.save_file">
<a class="viewcode-back" href="../Functions.html#Functions.editFunctions.save_file">[docs]</a>
    <span class="k">def</span> <span class="nf">save_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">asksaveasfilename</span><span class="p">(</span><span class="n">defaultextension</span><span class="o">=</span><span class="s2">&quot;.png&quot;</span><span class="p">,</span>
                                             <span class="n">filetypes</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;PNG files&quot;</span><span class="p">,</span> <span class="s2">&quot;*.png&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;All files&quot;</span><span class="p">,</span> <span class="s2">&quot;*.*&quot;</span><span class="p">)])</span>
        <span class="k">if</span> <span class="n">file_path</span><span class="p">:</span>
            <span class="n">outputImage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stripAlpha</span><span class="p">()</span>
            <span class="n">outputImage</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;not a valid file path to save image&quot;</span><span class="p">)</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Patrick Mika, Jason Styles, Hao Do Nguyen, Liam Bentley.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>